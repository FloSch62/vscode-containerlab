<!-- Floating Action Button with Radial Menu (Edit Mode Only) -->
<div id="floating-action-panel" class="fixed bottom-20 left-4 z-50" style="display: none;">
  <!-- Main FAB button -->
  <div id="fab-container" class="relative">
    <!-- Radial menu items (hidden by default) -->
    <div id="radial-menu" class="absolute opacity-0 pointer-events-none transition-all duration-300">
      <!-- Add Node button -->
      <button id="radial-add-node"
              class="radial-menu-item absolute w-12 h-12 rounded-full bg-[var(--vscode-button-background)] hover:bg-[var(--vscode-button-hoverBackground)] text-[var(--vscode-button-foreground)] shadow-lg transition-all duration-300 flex items-center justify-center"
              data-tippy-content="Add Node">
        <i class="fas fa-circle-nodes"></i>
      </button>
      
      <!-- Add Group button -->
      <button id="radial-add-group"
              class="radial-menu-item absolute w-12 h-12 rounded-full bg-[var(--vscode-button-background)] hover:bg-[var(--vscode-button-hoverBackground)] text-[var(--vscode-button-foreground)] shadow-lg transition-all duration-300 flex items-center justify-center"
              data-tippy-content="Add Group">
        <i class="fas fa-object-group"></i>
      </button>
      
      <!-- Add Text button -->
      <button id="radial-add-text"
              class="radial-menu-item absolute w-12 h-12 rounded-full bg-[var(--vscode-button-background)] hover:bg-[var(--vscode-button-hoverBackground)] text-[var(--vscode-button-foreground)] shadow-lg transition-all duration-300 flex items-center justify-center"
              data-tippy-content="Add Text">
        <i class="fas fa-font"></i>
      </button>
    </div>
    
    <!-- Main + button -->
    <button id="fab-main" 
            class="w-14 h-14 rounded-full bg-[var(--vscode-button-background)] hover:bg-[var(--vscode-button-hoverBackground)] text-[var(--vscode-button-foreground)] shadow-xl transition-all duration-300 flex items-center justify-center relative z-10">
      <i class="fas fa-plus text-xl transition-transform duration-300"></i>
    </button>
  </div>
</div>

<style>
  #floating-action-panel {
    /* Ensure it stays above other elements but below modals */
    z-index: 40;
  }
  
  #fab-main {
    /* Add subtle animation on hover */
    transition: transform 0.2s, box-shadow 0.2s, background-color 0.3s;
  }
  
  #fab-main:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
  }
  
  #fab-main.active {
    transform: rotate(45deg);
  }
  
  #fab-main.active:hover {
    transform: rotate(45deg) scale(1.05);
  }
  
  /* Radial menu positioning when active */
  #radial-menu.active {
    opacity: 1;
    pointer-events: auto;
  }
  
  /* Position menu items horizontally */
  .radial-menu-item {
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }
  
  /* Initial hidden state for radial items */
  #radial-menu:not(.active) .radial-menu-item {
    transform: translate(0, 0) scale(0);
    opacity: 0;
  }
  
  /* Horizontal expansion positioning */
  #radial-menu.active #radial-add-node {
    transform: translate(60px, 0px) scale(1);
    opacity: 1;
    transition-delay: 0.05s;
  }
  
  #radial-menu.active #radial-add-group {
    transform: translate(120px, 0px) scale(1);
    opacity: 1;
    transition-delay: 0.1s;
  }
  
  #radial-menu.active #radial-add-text {
    transform: translate(180px, 0px) scale(1);
    opacity: 1;
    transition-delay: 0.15s;
  }
  
  /* VS Code theme integration */
  #floating-action-panel button {
    border: 1px solid var(--vscode-button-border, transparent);
  }
  
  /* Subtle pulse animation for main button */
  @keyframes pulse {
    0% {
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    50% {
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
    100% {
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
  }
  
  #fab-main {
    animation: pulse 2s infinite;
  }
  
  #fab-main.active {
    animation: none;
  }
</style>

<script>
  // Show/hide floating action panel based on mode
  document.addEventListener('DOMContentLoaded', function() {
    const panel = document.getElementById('floating-action-panel');
    // Only show in edit mode (not viewer mode)
    if (panel && window.topoViewerMode !== 'viewer') {
      panel.style.display = 'block';
    }
  });
</script>